{% extends 'layout.twig' %}

{% block head %}
    {{ post.title }}
{% endblock %}

{% block content %}
    <section class="banner" style="background-image: url('./ressources/images/{{ post.image }}');">
        <div class="wrapper">
            <div class="title">
                <h1>{{ post.title }}</h1>
            </div>
        </div>
        {# <div class="vector-shape"> #}
            <img class="vector-shape vector-shape-bottom" src="./ressources/images/vector-bottom-right-white.svg" alt="">
        {# </div> #}
    </section>

    <main class="single">
        <div class="wrapper">
            {# <div class="posts"> #}
                <div class="post">
                    <div class="title">
                        {% if session.role == 'Admin' %}
                            <div class="actions">
                                <a href="index.php?action=updatePost&id={{ post.identifier }}">modifier</a>
                                <a href="index.php?action=deletePost&id={{ post.identifier }}">supprimer</a>
                            </div>
                        {% endif %}
                    </div>
                    <div class="content">
                        <p class="description">{{ post.content }}</p>
                        <p><span class="author">{{ post.username }}</span> le <span class="date">{{ post.creationDate }}</span></p>
                    </div>
                </div>
            {# </div> #}            
        </div>
    </main>
    {% if (comments is not empty) or (session.role is defined) %}
        <section class="comments">
            <img class="vector-shape vector-shape-top" src="./ressources/images/vector-top-left-white-2.svg" alt="">
            <div class="wrapper">
                {# <div class="title"> #}
                    <h2 class="title">Commentaires</h2>
                {# </div> #}
                {# <div class="comments"> #}
                {% for comment in comments %}
                    <div class="comment">
                        {# <div class="title"> #}
                            <p>{{ comment.username }}</p>
                            <p>Le {{ comment.creationDate }}</p>
                                {% if (session.role == 'Admin') or (session.id == comment.user_id) %}
                                <div class="actions">
                                    <a href="index.php?action=hideComment&id={{ comment.identifier }}">Masquer</a>
                                    <a href="index.php?action=updateComment&id={{ comment.identifier }}">Modifier</a>
                                    <a href="index.php?action=deleteComment&id={{ comment.identifier }}">Supprimer</a>
                                </div>
                                {% endif %}
                        {# </div> #}
                        <div class="content">
                            <p>{{ comment.comment }}</p>
                        </div>
                    </div>
                {% endfor %}
                {% if session.role is defined %}
                    <h2 class="title">Ajouter un commentaire</h2>
                    <form action="index.php?action=addComment&id={{ post.identifier }}" method="post">
                        <div class="user"></div>
                        <div>
                            <label for="comment">Commentaire</label><br />
                            <textarea id="comment" name="comment"></textarea>
                        </div>
                        <div>
                            <input type="submit" />
                        </div>
                    </form>
                {% endif %}
                {# </div> #}
            </div>
        </section>
    {% endif %}
{% endblock %}