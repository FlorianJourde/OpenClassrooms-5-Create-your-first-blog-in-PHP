{% extends 'layout.twig' %}

{% block head %}
    <title>Gestion des commentaires</title>
{% endblock %}

{% block content %}
    <a class="button-secondary" href="index.php">Accueil</a>

    <h1>Gestion des commentaires</h1>

    {% for post in posts %}
        <div class="post">
            <div class="title">
                <h3>{{ post.title }}</h3>
                {% if session.role == 'Admin' %}
                    <div class="actions">
                        <a href="index.php?action=updatePost&id={{ post.identifier }}">modifier</a>
                        <a href="index.php?action=deletePost&id={{ post.identifier }}">supprimer</a>
                    </div>
                {% endif %}
            </div>
            <div class="content">
                <p class="description">{{ post.content }}</p>
                <p><span class="author">{{ post.username }}</span> le <span class="date">{{ post.creationDate }}</span></p>
                <a class="button-secondary button-blue" href="index.php?action=post&id={{ post.identifier }}">Lire l'article</a>
            </div>
        </div>

        {% for comment in post.hiddenComments %}
            <div class="comment">
                <div class="title">
                    <p><strong>{{ comment.username }}</strong> le {{ comment.creationDate }}</p>
                        {% if (session.role == 'Admin') or (session.id == comment.user_id) %}
                        <div class="actions">
                            <a href="index.php?action=updateComment&id={{ comment.identifier }}">modifier</a>
                            <a href="index.php?action=deleteComment&id={{ comment.identifier }}">supprimer</a>
                        </div>
                        {% endif %}
                </div>
                <div class="content">
                    <p>{{ comment.comment }}</p>
                </div>
            </div>
        {% endfor %}
    {% endfor %}
{% endblock %}